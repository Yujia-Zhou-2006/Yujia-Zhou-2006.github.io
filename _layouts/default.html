<!doctype html>
<html lang="en" data-color-mode="auto">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ page.title | default: site.title }}</title>
  <link rel="stylesheet" href="https://unpkg.com/@primer/css@^21/dist/primer.css">
  <link rel="stylesheet" href="{{ '/assets/styles/theme-tokens.css' | relative_url }}">
  
  <!-- 防闪白脚本 - 必须在head中立即执行 -->
  <script>
    (function(){
      const KEY='colorMode';
      const html=document.documentElement;
      
      function getMode(){
        const mode = localStorage.getItem(KEY) || 'auto';
        if(mode==='light'||mode==='dark') return mode;
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        return prefersDark ? 'dark' : 'light';
      }
      
      function apply(mode){
        if(mode==='light' || mode==='dark'){ html.setAttribute('data-color-mode', mode); }
        else {
          const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          html.setAttribute('data-color-mode', prefersDark ? 'dark' : 'light');
        }
      }
      
      // 立即应用主题，防止闪白
      apply(localStorage.getItem(KEY) || 'auto');
    })();
  </script>
</head>
<body>
  {% include header.html %}
  <main class="container-xl px-3 my-4 my-md-6">
    {{ content }}
  </main>
  {% include footer.html %}
  <script src="{{ '/assets/scripts/theme-toggle.js' | relative_url }}"></script>
  <script src="{{ '/assets/scripts/copy-wechat.js' | relative_url }}"></script>
</body>
</html>
